import{h as b,r as d,u as A,j as c,T as F,A as x,f as i}from"./index-eab7dac9.js";import{P as C}from"./ProductForm-1e25a1b1.js";const N=()=>{const{slug:p}=b(),[t,u]=d.useState({name:"",desc:"",sku:"",price:"",color:"",brand:"",material:"",category:"",featured:"false"}),[l,h]=d.useState(null),[g,f]=d.useState([]),m=A(),[P,j]=d.useState(!0);d.useEffect(()=>{(async()=>{var n,o;try{const a=await x.get(`/product/${p}`);h(a.data.data.image);const r=[...g];a.data.data.sizeQuantity.forEach(s=>{r[s.size-3]={size:s.size,quantity:s.quantity}}),f(r),u({...t,brand:a.data.data.brand,color:a.data.data.color,desc:a.data.data.description,featured:a.data.data.isFeatured,material:a.data.data.material,name:a.data.data.name,price:a.data.data.price,sku:a.data.data.sku,category:a.data.data.category}),j(!1)}catch(a){i.error(((o=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:o.message)||"Something went wrong",{position:"bottom-right"}),m("/admin/products")}})()},[]);const k=e=>{f(e)},v=e=>{h(e)},w=e=>{u({...t,category:e})},z=e=>{u({...t,[e.target.id]:e.target.value})},S=async e=>{var n,o;e.preventDefault();try{const a=localStorage.getItem("jwtAdmin");if(!a)return i.error("Access denied.");const r=g.filter(y=>y&&y.quantity>0);if(console.log({...t,sizeQuantity:r,image:l}),r.length===0||!t.name||!t.desc||!t.sku||!t.price||!t.color||!t.brand||!t.material||!l)return i.error("Please fill all the fields.");const s=await x.put(`/product/update/${p}`,{...t,sizeQuantity:r,image:l},{headers:{Authorization:a}});console.log(s),s.data.success&&(i.success(s.data.message),m("/admin/products"))}catch(a){i.error((o=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:o.message),console.log(a)}};return P?c.jsx(F,{height:"500px"}):c.jsxs("div",{className:"orderMainContainer",children:[c.jsx("h1",{className:"cHeader",style:{textAlign:"left",marginBottom:"1rem"},children:"Update Product"}),c.jsx("div",{className:"dashOverview",children:c.jsx(C,{link:l,changeLink:v,data:t,handleInputChange:z,fields:g,changeFields:k,name:"Update Product",changeCategory:w,handleSubmit:S,handleCancel:()=>m("/admin/products")})})]})};export{N as default};
