import{r as c,j as e,T as D,E as C,P as I,f as n,A as v}from"./index-eab7dac9.js";const k=()=>{const[l,h]=c.useState([]),[y,m]=c.useState(!0),[t,o]=c.useState(1),[x,E]=c.useState(8),[u,b]=c.useState(0),f=t>1,P=t<u,A=s=>{o(s)},w=async()=>{try{const s=localStorage.getItem("jwtAdmin");if(!s)return n.error("Access denied.");const a=await v.get("/admin/order",{params:{limit:x,page:t},headers:{Authorization:s}});console.log(a.data),h(a.data.orders),b(Math.ceil(a.data.count/x)),m(!1)}catch{m(!1)}},j=async(s,a,r)=>{var g,p;try{const d=localStorage.getItem("jwtAdmin");if(!d)return n.error("Access denied.");const N=await v.put("/admin/order",{id:s,status:a,paymentId:r},{headers:{Authorization:d}});if(N.data.success){const S=l.map(i=>(i._id===s&&(i.delivered=a),i));h(S),n.success(N.data.message)}}catch(d){n.error((p=(g=d==null?void 0:d.response)==null?void 0:g.data)==null?void 0:p.message)}};return c.useEffect(()=>{w()},[t]),y?e.jsx(D,{height:"500px"}):e.jsxs("div",{className:"orderMainContainer",children:[e.jsx("h1",{className:"cHeader",style:{textAlign:"left"},children:"Orders List"}),e.jsxs("div",{className:"orderContainer",style:{flexDirection:"column"},children:[e.jsxs("table",{className:"order-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"order-subheader order-th",style:{textAlign:"left"},children:"Product Details"}),e.jsx("th",{className:"order-subheader order-th ",children:"Customer"}),e.jsx("th",{className:"order-subheader order-th ",children:"Order Date"}),e.jsx("th",{className:"order-subheader order-th ",children:"Status"}),e.jsx("th",{className:"order-subheader order-th ",children:"Total Price"}),e.jsx("th",{className:"order-subheader order-th ",children:"Action"})]})}),e.jsx("tbody",{className:"order-table-tbody",children:l.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"order-td",children:s.products.map(r=>e.jsx("div",{className:"order-td-div",children:e.jsxs("div",{className:"cart-product-cont",children:[e.jsx("div",{className:"cart-image-cont",children:e.jsx("img",{src:r.image,alt:"product",className:"cart-image"})}),e.jsxs("div",{className:"cart-product-details",children:[e.jsx("p",{className:"cart-name-cont",style:{width:"13rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r.name}),e.jsx("p",{className:"cart-desc-cont",children:r.desc})]})]})},r._id))}),e.jsx("td",{className:"order-td",children:s.user}),e.jsx("td",{className:"order-td",children:s.createdAt}),e.jsx("td",{className:"order-td",children:s.delivered}),e.jsxs("td",{className:"order-td",children:["â‚¹",s.total]}),e.jsx("td",{className:"order-td",children:e.jsxs("div",{className:"order-btn-cont",style:{flexDirection:"column"},children:[e.jsx("button",{className:"cart-delete-btn",disabled:s.delivered!=="pending",style:s.delivered!=="pending"?{cursor:"not-allowed",opacity:"0.5"}:{},onClick:()=>j(s._id,"Delivered",s.paymentId),children:"Delivered"}),e.jsx("button",{className:"cart-delete-btn",disabled:s.delivered!=="pending",style:s.delivered!=="pending"?{cursor:"not-allowed",opacity:"0.5"}:{},onClick:()=>j(s._id,"Cancelled",s.paymentId),children:"Cancel"})]})})]},a))})]}),(!l||l.length<=0)&&e.jsxs("div",{className:"empty-cart",children:[e.jsx("img",{src:C,alt:"empty-cart"}),e.jsx("p",{children:"No orders have been placed yet."})]})]}),e.jsx(I,{totalPageCount:u,previousPage:()=>o(t-1),canPreviousPage:f,nextPage:()=>o(t+1),canNextPage:P,gotoPage:A,pageIndex:t-1})]})};export{k as default};
